# ==============================================================================
# 1MIN-GATEWAY - FICHIER DE CONFIGURATION ENVIRONNEMENT
# ==============================================================================
# ⚠️ IMPORTANT: Ce fichier est un TEMPLATE
# 1. Copier ce fichier: cp .env.example .env
# 2. Remplir les valeurs réelles dans .env
# 3. NE JAMAIS commiter le fichier .env (déjà dans .gitignore)
# ==============================================================================

# ==============================================================================
# 1. AUTHENTIFICATION 1MIN.AI (OBLIGATOIRE)
# ==============================================================================
# Récupérez votre clé API sur https://1min.ai/profile
# Format: sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ONE_MIN_AI_API_KEY=your_api_key_here

# Endpoints officiels (2026)
ONE_MIN_API_URL=https://api.1min.ai/api/features
ONE_MIN_CONVERSATION_API_STREAMING_URL=https://api.1min.ai/api/features/stream
ONE_MIN_ASSET_URL=https://api.1min.ai/api/assets

# ==============================================================================
# 2. CONFIGURATION SERVEUR (FLASK/WAITRESS)
# ==============================================================================
APP_NAME=1min-Gateway
APP_ENV=production        # Options: development, testing, production
DEBUG=False               # ⚠️ TOUJOURS False en production
HOST=0.0.0.0              # Permet l'accès externe (Docker)
PORT=5001                 # Port d'écoute

# ==============================================================================
# 3. AUTHENTIFICATION DOCKER (Pour Watchtower)
# ==============================================================================
# ⚠️ SÉCURITÉ: Ces credentials permettent à Watchtower de pull des images
# privées. Utilisez un Access Token, JAMAIS votre mot de passe Docker Hub.
#
# Créer un token: https://hub.docker.com/settings/security
DOCKER_USER=your_dockerhub_username
DOCKER_TOKEN=dckr_pat_xxxxxxxxxxxxxxxxxxxxx

# ==============================================================================
# 4. CONFIGURATION MEMCACHED
# ==============================================================================
MEMCACHED_HOST=memcached  # Nom du service Docker Compose
MEMCACHED_PORT=11211      # Port par défaut

# ==============================================================================
# 5. FILTRAGE ET GESTION DES MODÈLES
# ==============================================================================
# Si True, le Gateway ne listera QUE les modèles définis ci-dessous
PERMIT_MODELS_FROM_SUBSET_ONLY=False

# Liste des modèles autorisés (séparés par des virgules, sans espaces)
# Exemples: gpt-4o,gpt-4o-mini,claude-3-5-sonnet,gemini-1.5-pro,mistral-nemo,deepseek-chat
SUBSET_OF_ONE_MIN_PERMITTED_MODELS=mistral-nemo,gpt-4o-mini,deepseek-chat

# ==============================================================================
# 6. LIMITATION DE DÉBIT (RATE LIMITING)
# ==============================================================================
RATELIMIT_ENABLED=True

# Stockage pour le limiteur
# - memory://            → Simple, pour développement/single instance
# - redis://host:port/0  → Production recommandée (multi-instance)
# - memcached://host:port → Alternative légère
RATELIMIT_STORAGE_URL=memcache://memcached:11211

# Limites par défaut (format: "X per Y" où Y = second, minute, hour, day)
RATELIMIT_DEFAULT=500 per minute
RATELIMIT_MODELS_LIST=20 per minute

# ==============================================================================
# 7. LOGGING ET MONITORING
# ==============================================================================
# Niveaux: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Format des logs (json pour production, text pour dev)
LOG_FORMAT=json           # Options: json, text
LOG_FILE=/app/logs/gateway.log

# ==============================================================================
# 8. SÉCURITÉ
# ==============================================================================
# Secret key pour Flask sessions (générer avec: python -c "import secrets; print(secrets.token_hex(32))")
SECRET_KEY=change_me_to_a_random_secret_key

# CORS configuration (liste d'origines autorisées, séparées par des virgules)
CORS_ORIGINS=*            # ⚠️ En production, remplacer par vos domaines: https://app.example.com,https://www.example.com
CORS_ALLOW_CREDENTIALS=True

# ==============================================================================
# 9. CONFIGURATION DOCKER (OPTIONNEL - pour vos scripts de build)
# ==============================================================================
DOCKER_IMAGE_NAME=billelattafi/1min-gateway
DOCKER_REGISTRY=docker.io
DOCKER_BUILDKIT=1

# ==============================================================================
# 10. DÉVELOPPEMENT (ignorer en production)
# ==============================================================================
# Flask reload automatique (dev seulement)
FLASK_DEBUG=False
FLASK_ENV=production

# ==============================================================================
# CHECKLIST DE SÉCURITÉ
# ==============================================================================
# [ ] ONE_MIN_AI_API_KEY renseignée
# [ ] DOCKER_TOKEN est un Access Token (pas un mot de passe)
# [ ] SECRET_KEY est aléatoire et unique
# [ ] DEBUG=False en production
# [ ] LOG_LEVEL=INFO ou WARNING en production
# [ ] CORS_ORIGINS limité aux domaines autorisés
# [ ] Fichier .env dans .gitignore
# [ ] Permissions .env = 600 (chmod 600 .env)
# ==============================================================================
